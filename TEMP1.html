{{- define "partials/inline/menu/walk.html" }}
  {{- $page := .page }}
  {{- range $index, .menuEntries }}
    {{- $attrs := dict "href" .URL "class" "nav-link" }}
    {{- $class := "nav-item" }}
    {{- if $page.IsMenuCurrent .Menu . }}
      {{- $attrs = merge $attrs (dict "class" "nav-link active" "aria-current" "page") }}
      {{- $class = "nav-item active" }}
    {{- else if $page.HasMenuCurrent .Menu . }}
      {{- $attrs = merge $attrs (dict "class" "nav-link ancestor" "aria-current" "true") }}
      {{- $class = "nav-item ancestor" }}
    {{- end }}

    {{- if .HasChildren }}
      <li class="nav-item">
        <!-- Accordion wrapper for dropdown -->
        <div class="accordion" id="accordion-{{ $index }}">
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading-{{ $index }}">
              <a class="nav-link dropdown-toggle pb-0" href="#" id="navbarDropdown-{{ .Name | urlize }}" role="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{ $index }}" aria-expanded="false" aria-controls="collapse-{{ $index }}">
                {{ .Name }}
              </a>
            </h2>
            <div id="collapse-{{ $index }}" class="accordion-collapse collapse" aria-labelledby="heading-{{ $index }}" data-bs-parent="#accordion-{{ $index }}">
              <div class="accordion-body p-0">
                <ul class="dropdown-menu show border-0 end-0 text-end text-md-start">
                  {{- range .Children }}
                    <li>
                      <a class="dropdown-item" href="{{ .URL }}">
                        {{ .Name }}
                      </a>
                    </li>
                  {{- end }}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </li>
    {{- else }}
      <li class="{{ $class }}">
        <a
          {{- range $k, $v := $attrs }}
            {{- with $v }}
              {{- printf " %s=%q" $k $v | safeHTMLAttr }}
            {{- end }}
          {{- end -}}
        >{{ .Name }}</a>
      </li>
    {{- end }}
  {{- end }}
{{- end }}

